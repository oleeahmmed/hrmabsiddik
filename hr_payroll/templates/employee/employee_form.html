{% extends 'base.html' %}
{% load static %}

{% block title %}{% if object %}Edit Employee - {{ object.name }}{% else %}Add New Employee{% endif %} - HRM System{% endblock %}

{% block page_title %}{% if object %}Edit Employee{% else %}Add New Employee{% endif %}{% endblock %}
{% block page_subtitle %}{% if object %}Update details for {{ object.name }}{% else %}Create a new employee record{% endif %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <div class="bg-card/80 backdrop-blur-lg border border-border rounded-lg shadow-lg overflow-hidden">
        <!-- Form Header -->
        <div class="bg-gradient-to-r from-primary/10 to-primary/5 border-b border-border p-6">
            <div class="flex items-center justify-between">
                <div>
                    <h1 class="text-2xl font-bold text-foreground">Employee Information Form</h1>
                    <p class="text-muted-foreground mt-1">
                        {% if object %}Update employee details{% else %}Add a new employee to the system{% endif %}
                    </p>
                </div>
                <a href="{% url 'zkteco:employee_list' %}" class="btn btn-outline">
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
                    </svg>
                    Back to Employees
                </a>
            </div>
        </div>

        <!-- Form Content -->
        <div class="p-6">
            <form method="post" class="space-y-8" id="employee-form">
                {% csrf_token %}
                
                <!-- Form Errors Alert -->
                {% if form.non_field_errors %}
                <div class="card p-4 bg-destructive-light border-destructive/30 animate-slide-in">
                    <div class="flex items-start space-x-3">
                        <div class="flex-shrink-0">
                            <svg class="w-5 h-5 text-destructive" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                            </svg>
                        </div>
                        <div class="flex-1">
                            <h4 class="text-sm font-semibold text-destructive mb-2">Please correct the following errors:</h4>
                            <ul class="list-disc list-inside space-y-1 text-sm text-destructive">
                                {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Personal Information Section -->
                <div class="border-b border-border pb-6">
                    <h2 class="text-xl font-semibold text-foreground mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        Personal Information
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="form-group">
                            <label for="{{ form.employee_id.id_for_label }}" class="form-label required">Employee ID</label>
                            {{ form.employee_id }}
                            {% if form.employee_id.errors %}
                            <p class="form-error">{{ form.employee_id.errors.0 }}</p>
                            {% endif %}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.zkteco_id.id_for_label }}" class="form-label">ZKTeco ID</label>
                            {{ form.zkteco_id }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.name.id_for_label }}" class="form-label required">Full Name</label>
                            {{ form.name }}
                            {% if form.name.errors %}
                            <p class="form-error">{{ form.name.errors.0 }}</p>
                            {% endif %}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.first_name.id_for_label }}" class="form-label">First Name</label>
                            {{ form.first_name }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.last_name.id_for_label }}" class="form-label">Last Name</label>
                            {{ form.last_name }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.gender.id_for_label }}" class="form-label">Gender</label>
                            {{ form.gender }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.date_of_birth.id_for_label }}" class="form-label">Date of Birth</label>
                            {{ form.date_of_birth }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.blood_group.id_for_label }}" class="form-label">Blood Group</label>
                            {{ form.blood_group }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.marital_status.id_for_label }}" class="form-label">Marital Status</label>
                            {{ form.marital_status }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.nid.id_for_label }}" class="form-label">National ID</label>
                            {{ form.nid }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.passport_no.id_for_label }}" class="form-label">Passport Number</label>
                            {{ form.passport_no }}
                        </div>

                        <div class="form-group">
                            <div class="card p-4 bg-primary-light border-primary/30">
                                <label class="flex items-center space-x-3 cursor-pointer">
                                    {{ form.is_active }}
                                    <div>
                                        <span class="text-sm font-semibold text-foreground block">Active Employee</span>
                                        <span class="text-xs text-muted-foreground">Employee is currently active in the system</span>
                                    </div>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contact Information Section -->
                <div class="border-b border-border pb-6">
                    <h2 class="text-xl font-semibold text-foreground mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                        </svg>
                        Contact Information
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="space-y-4">
                            <div class="form-group">
                                <label for="{{ form.contact_number.id_for_label }}" class="form-label">Contact Number</label>
                                {{ form.contact_number }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.email.id_for_label }}" class="form-label">Email Address</label>
                                {{ form.email }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.present_address.id_for_label }}" class="form-label">Present Address</label>
                                {{ form.present_address }}
                            </div>
                        </div>

                        <div class="space-y-4">
                            <div class="card p-4 bg-warning-light border-warning/30">
                                <h4 class="text-sm font-semibold text-foreground mb-3 flex items-center">
                                    <svg class="w-4 h-4 mr-2 text-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-1.732-1.333-2.5 0L4.268 16c-.77 1.333.192 3 1.732 3z"/>
                                    </svg>
                                    Emergency Contact
                                </h4>
                                <div class="space-y-3">
                                    <div class="form-group">
                                        <label for="{{ form.emergency_contact_name.id_for_label }}" class="form-label">Name</label>
                                        {{ form.emergency_contact_name }}
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.emergency_contact.id_for_label }}" class="form-label">Phone Number</label>
                                        {{ form.emergency_contact }}
                                    </div>
                                    <div class="form-group">
                                        <label for="{{ form.emergency_contact_relation.id_for_label }}" class="form-label">Relationship</label>
                                        {{ form.emergency_contact_relation }}
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="{{ form.permanent_address.id_for_label }}" class="form-label">Permanent Address</label>
                                {{ form.permanent_address }}
                                <button type="button" id="copy-address-btn" class="btn btn-outline btn-sm mt-2">
                                    <svg class="w-3 h-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                                    </svg>
                                    Copy from Present Address
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Employment Details Section -->
                <div class="border-b border-border pb-6">
                    <h2 class="text-xl font-semibold text-foreground mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                        </svg>
                        Employment Details
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="form-group">
                            <label for="{{ form.company.id_for_label }}" class="form-label required">Company</label>
                            {{ form.company }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.department.id_for_label }}" class="form-label">Department</label>
                            {{ form.department }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.designation.id_for_label }}" class="form-label">Designation</label>
                            {{ form.designation }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.job_type.id_for_label }}" class="form-label">Job Type</label>
                            {{ form.job_type }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.employment_status.id_for_label }}" class="form-label">Employment Status</label>
                            {{ form.employment_status }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.default_shift.id_for_label }}" class="form-label">Default Shift</label>
                            {{ form.default_shift }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.user.id_for_label }}" class="form-label">System User Account</label>
                            {{ form.user }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.joining_date.id_for_label }}" class="form-label">Joining Date</label>
                            {{ form.joining_date }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.confirmation_date.id_for_label }}" class="form-label">Confirmation Date</label>
                            {{ form.confirmation_date }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.resignation_date.id_for_label }}" class="form-label">Resignation Date</label>
                            {{ form.resignation_date }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.termination_date.id_for_label }}" class="form-label">Termination Date</label>
                            {{ form.termination_date }}
                        </div>
                    </div>
                </div>

                <!-- Education Section -->
                <div class="border-b border-border pb-6">
                    <h2 class="text-xl font-semibold text-foreground mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path d="M12 14l9-5-9-5-9 5 9 5z"/>
                            <path d="M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 14l9-5-9-5-9 5 9 5zm0 0l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14zm-4 6v-7.5l4-2.222"/>
                        </svg>
                        Educational Information
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="form-group">
                            <label for="{{ form.highest_education.id_for_label }}" class="form-label">Highest Education</label>
                            {{ form.highest_education }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.university.id_for_label }}" class="form-label">University/Institution</label>
                            {{ form.university }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.passing_year.id_for_label }}" class="form-label">Passing Year</label>
                            {{ form.passing_year }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.skills.id_for_label }}" class="form-label">Skills</label>
                            {{ form.skills }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.experience.id_for_label }}" class="form-label">Previous Experience</label>
                            {{ form.experience }}
                        </div>

                        <div class="form-group md:col-span-3">
                            <label for="{{ form.bio.id_for_label }}" class="form-label">Bio/Description</label>
                            {{ form.bio }}
                        </div>
                    </div>
                </div>

                <!-- Salary & Working Hours Section -->
                <div class="border-b border-border pb-6">
                    <h2 class="text-xl font-semibold text-foreground mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Salary & Working Hours
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="form-group">
                            <label for="{{ form.base_salary.id_for_label }}" class="form-label">Monthly Basic Salary</label>
                            {{ form.base_salary }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.expected_working_hours.id_for_label }}" class="form-label">Expected Working Hours (Daily)</label>
                            {{ form.expected_working_hours }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.per_hour_rate.id_for_label }}" class="form-label">Per Hour Rate</label>
                            {{ form.per_hour_rate }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.overtime_rate.id_for_label }}" class="form-label">Overtime Rate (per hour)</label>
                            {{ form.overtime_rate }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.overtime_grace_minutes.id_for_label }}" class="form-label">Grace Minutes</label>
                            {{ form.overtime_grace_minutes }}
                        </div>
                    </div>
                </div>

                <!-- Allowances & Deductions Section -->
                <div class="border-b border-border pb-6">
                    <h2 class="text-xl font-semibold text-foreground mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/>
                        </svg>
                        Allowances & Deductions
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Allowances -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-medium text-foreground mb-2">Allowances</h3>
                            <div class="form-group">
                                <label for="{{ form.house_rent_allowance.id_for_label }}" class="form-label">House Rent Allowance</label>
                                {{ form.house_rent_allowance }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.medical_allowance.id_for_label }}" class="form-label">Medical Allowance</label>
                                {{ form.medical_allowance }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.conveyance_allowance.id_for_label }}" class="form-label">Conveyance Allowance</label>
                                {{ form.conveyance_allowance }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.food_allowance.id_for_label }}" class="form-label">Food Allowance</label>
                                {{ form.food_allowance }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.attendance_bonus.id_for_label }}" class="form-label">Attendance Bonus</label>
                                {{ form.attendance_bonus }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.festival_bonus.id_for_label }}" class="form-label">Festival Bonus</label>
                                {{ form.festival_bonus }}
                            </div>
                        </div>

                        <!-- Deductions -->
                        <div class="space-y-4">
                            <h3 class="text-lg font-medium text-foreground mb-2">Deductions</h3>
                            <div class="form-group">
                                <label for="{{ form.provident_fund.id_for_label }}" class="form-label">Provident Fund</label>
                                {{ form.provident_fund }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.tax_deduction.id_for_label }}" class="form-label">Tax Deduction</label>
                                {{ form.tax_deduction }}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.loan_deduction.id_for_label }}" class="form-label">Loan Deduction</label>
                                {{ form.loan_deduction }}
                            </div>

                            <!-- Summary Card -->
                            <div class="card p-4 gradient-mesh mt-4">
                                <h4 class="text-sm font-semibold text-foreground mb-3">Salary Summary</h4>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between items-center py-2 border-b border-border">
                                        <span class="text-muted-foreground">Base Salary:</span>
                                        <span class="font-semibold text-foreground" id="summary-base">৳ 0.00</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-border">
                                        <span class="text-success">+ Total Allowances:</span>
                                        <span class="font-semibold text-success" id="summary-allowances">৳ 0.00</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 border-b border-border">
                                        <span class="text-destructive">- Total Deductions:</span>
                                        <span class="font-semibold text-destructive" id="summary-deductions">৳ 0.00</span>
                                    </div>
                                    <div class="flex justify-between items-center py-2 bg-primary-light rounded-md px-2">
                                        <span class="font-bold text-foreground">Net Salary:</span>
                                        <span class="font-bold text-primary text-lg" id="summary-net">৳ 0.00</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Banking Information Section -->
                <div>
                    <h2 class="text-xl font-semibold text-foreground mb-4 flex items-center">
                        <svg class="w-5 h-5 mr-2 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"/>
                        </svg>
                        Banking & Payment Information
                    </h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                        <div class="form-group">
                            <label for="{{ form.bank_name.id_for_label }}" class="form-label">Bank Name</label>
                            {{ form.bank_name }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.bank_account_no.id_for_label }}" class="form-label">Bank Account Number</label>
                            {{ form.bank_account_no }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.bank_branch.id_for_label }}" class="form-label">Bank Branch</label>
                            {{ form.bank_branch }}
                        </div>

                        <div class="form-group">
                            <label for="{{ form.payment_method.id_for_label }}" class="form-label">Payment Method</label>
                            {{ form.payment_method }}
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="flex items-center justify-between pt-6 border-t border-border">
                    <button type="reset" class="btn btn-secondary">
                        <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        Reset Form
                    </button>
                    
                    <button type="submit" class="btn btn-primary">
                        <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
                        </svg>
                        {% if object %}Update Employee{% else %}Create Employee{% endif %}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
    /* Form Styles */
    .form-label {
        display: block;
        font-size: 0.875rem;
        font-weight: 500;
        color: hsl(var(--foreground));
        margin-bottom: 0.5rem;
    }
    
    .form-label.required::after {
        content: ' *';
        color: hsl(var(--destructive));
    }
    
    .form-group {
        margin-bottom: 0;
    }
    
    .form-help {
        font-size: 0.75rem;
        color: hsl(var(--muted-foreground));
        margin-top: 0.25rem;
    }
    
    .form-error {
        font-size: 0.75rem;
        color: hsl(var(--destructive));
        margin-top: 0.25rem;
        display: flex;
        align-items: center;
    }
    
    .form-error::before {
        content: '⚠️';
        margin-right: 0.25rem;
    }

    /* Input Field Styles - Perfect for Both Light & Dark Mode */
    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="number"],
    input[type="date"],
    input[type="tel"],
    input[type="url"],
    select,
    textarea {
        width: 100%;
        padding: 0.75rem 1rem;
        background-color: #ffffff;
        border: 1px solid #e5e7eb;
        border-radius: var(--radius);
        color: #1f2937;
        font-size: 0.875rem;
        line-height: 1.5;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        font-family: inherit;
    }

    /* Dark Mode Specific Styles - Much Better Contrast */
    .dark input[type="text"],
    .dark input[type="email"],
    .dark input[type="password"],
    .dark input[type="number"],
    .dark input[type="date"],
    .dark input[type="tel"],
    .dark input[type="url"],
    .dark select,
    .dark textarea {
        background-color: #1e293b;
        border-color: #334155;
        color: #f1f5f9;
    }

    /* Focus States - Light Mode */
    input:focus,
    select:focus,
    textarea:focus {
        outline: none;
        border-color: hsl(var(--primary));
        box-shadow: 0 0 0 3px hsl(var(--primary) / 0.1);
        background-color: #ffffff;
    }

    /* Focus States - Dark Mode */
    .dark input:focus,
    .dark select:focus,
    .dark textarea:focus {
        background-color: #0f172a;
        border-color: hsl(var(--primary));
        box-shadow: 0 0 0 3px hsl(var(--primary) / 0.3);
        color: #ffffff;
    }

    /* Hover States - Light Mode */
    input:hover:not(:focus),
    select:hover:not(:focus),
    textarea:hover:not(:focus) {
        border-color: #9ca3af;
        background-color: #f9fafb;
    }

    /* Hover States - Dark Mode */
    .dark input:hover:not(:focus),
    .dark select:hover:not(:focus),
    .dark textarea:hover:not(:focus) {
        border-color: #475569;
        background-color: #0f172a;
    }

    /* Placeholder Styles - Light Mode */
    input::placeholder,
    textarea::placeholder {
        color: #9ca3af;
    }

    /* Placeholder Styles - Dark Mode */
    .dark input::placeholder,
    .dark textarea::placeholder {
        color: #64748b;
    }

    /* Disabled/Readonly States - Light Mode */
    input:disabled,
    input[readonly],
    select:disabled,
    textarea:disabled,
    textarea[readonly] {
        background-color: #f3f4f6;
        color: #6b7280;
        cursor: not-allowed;
        opacity: 0.7;
    }

    /* Disabled/Readonly States - Dark Mode */
    .dark input:disabled,
    .dark input[readonly],
    .dark select:disabled,
    .dark textarea:disabled,
    .dark textarea[readonly] {
        background-color: #1e293b;
        color: #64748b;
        border-color: #334155;
        opacity: 0.6;
    }

    /* Checkbox Styling */
    input[type="checkbox"] {
        width: 1.25rem;
        height: 1.25rem;
        padding: 0;
        border-radius: 0.375rem;
        cursor: pointer;
        accent-color: hsl(var(--primary));
        background-color: #ffffff;
        border: 1px solid #d1d5db;
    }

    .dark input[type="checkbox"] {
        background-color: #1e293b;
        border-color: #475569;
    }

    /* Select Dropdown Arrow - Light Mode */
    select {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
        background-position: right 0.75rem center;
        background-repeat: no-repeat;
        background-size: 1.25rem 1.25rem;
        padding-right: 2.5rem;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
    }

    /* Select Dropdown Arrow - Dark Mode */
    .dark select {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23cbd5e1' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
    }

    /* Select Options - Dark Mode */
    .dark select option {
        background-color: #1e293b;
        color: #f1f5f9;
    }

    /* Date Input Specific Styling */
    input[type="date"] {
        position: relative;
        padding-right: 2.5rem;
    }

    input[type="date"]::-webkit-calendar-picker-indicator {
        cursor: pointer;
        filter: none;
        opacity: 0.6;
    }

    .dark input[type="date"]::-webkit-calendar-picker-indicator {
        filter: invert(1);
        opacity: 0.9;
    }

    /* Number Input Arrows */
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
        opacity: 0.6;
    }

    .dark input[type="number"]::-webkit-inner-spin-button,
    .dark input[type="number"]::-webkit-outer-spin-button {
        filter: invert(1);
        opacity: 0.8;
    }

    /* Textarea Specific */
    textarea {
        resize: vertical;
        min-height: 80px;
    }

    /* Error State - Light Mode */
    input.error,
    select.error,
    textarea.error,
    input:invalid:not(:placeholder-shown),
    select:invalid:not(:placeholder-shown),
    textarea:invalid:not(:placeholder-shown) {
        border-color: #ef4444;
        background-color: #fef2f2;
    }

    /* Error State - Dark Mode */
    .dark input.error,
    .dark select.error,
    .dark textarea.error,
    .dark input:invalid:not(:placeholder-shown),
    .dark select:invalid:not(:placeholder-shown),
    .dark textarea:invalid:not(:placeholder-shown) {
        border-color: #ef4444;
        background-color: #3f1515;
        color: #fca5a5;
    }

    /* Success State - Light Mode */
    input.success,
    select.success,
    textarea.success {
        border-color: #10b981;
        background-color: #f0fdf4;
    }

    /* Success State - Dark Mode */
    .dark input.success,
    .dark select.success,
    .dark textarea.success {
        border-color: #10b981;
        background-color: #153e2d;
        color: #a7f3d0;
    }

    /* Card Styling */
    .card {
        background-color: hsl(var(--card));
        border: 1px solid hsl(var(--border));
        border-radius: var(--radius);
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    }

    .dark .card {
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3), 0 1px 2px 0 rgba(0, 0, 0, 0.2);
    }

    /* Button Styles */
    .btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 0.625rem 1.25rem;
        font-size: 0.875rem;
        font-weight: 500;
        border-radius: var(--radius);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: pointer;
        border: 1px solid transparent;
        line-height: 1.25rem;
    }

    .btn-primary {
        background-color: hsl(var(--primary));
        color: hsl(var(--primary-foreground));
        box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
    }

    .btn-primary:hover {
        background-color: hsl(var(--primary) / 0.9);
        transform: translateY(-1px);
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    .btn-secondary {
        background-color: hsl(var(--secondary));
        color: hsl(var(--secondary-foreground));
        border-color: hsl(var(--border));
    }

    .btn-secondary:hover {
        background-color: hsl(var(--secondary) / 0.8);
        transform: translateY(-1px);
    }

    .btn-outline {
        background-color: transparent;
        color: hsl(var(--foreground));
        border-color: hsl(var(--border));
    }

    .btn-outline:hover {
        background-color: hsl(var(--accent));
        color: hsl(var(--accent-foreground));
        transform: translateY(-1px);
    }

    .btn-sm {
        padding: 0.5rem 1rem;
        font-size: 0.75rem;
    }

    /* Animation */
    .animate-slide-in {
        animation: slideIn 0.3s ease-out;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Gradient Mesh Background */
    .gradient-mesh {
        background: linear-gradient(135deg, hsl(var(--primary) / 0.05) 0%, hsl(var(--secondary) / 0.05) 100%);
        border: 1px solid hsl(var(--border));
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .grid-cols-3 {
            grid-template-columns: 1fr;
        }
        
        .md\:col-span-3 {
            grid-column: span 1;
        }
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Copy present address to permanent address
        const copyAddressBtn = document.getElementById('copy-address-btn');
        if (copyAddressBtn) {
            copyAddressBtn.addEventListener('click', function() {
                const presentAddress = document.getElementById('{{ form.present_address.id_for_label }}');
                const permanentAddress = document.getElementById('{{ form.permanent_address.id_for_label }}');
                if (presentAddress && permanentAddress) {
                    permanentAddress.value = presentAddress.value;
                    // Show success feedback
                    showToast('Address copied successfully!', 'success');
                }
            });
        }

        // Calculate salary summary
        function calculateSalarySummary() {
            const baseSalary = parseFloat(document.getElementById('{{ form.base_salary.id_for_label }}').value) || 0;
            const houseRent = parseFloat(document.getElementById('{{ form.house_rent_allowance.id_for_label }}').value) || 0;
            const medical = parseFloat(document.getElementById('{{ form.medical_allowance.id_for_label }}').value) || 0;
            const conveyance = parseFloat(document.getElementById('{{ form.conveyance_allowance.id_for_label }}').value) || 0;
            const food = parseFloat(document.getElementById('{{ form.food_allowance.id_for_label }}').value) || 0;
            const attendanceBonus = parseFloat(document.getElementById('{{ form.attendance_bonus.id_for_label }}').value) || 0;
            const festivalBonus = parseFloat(document.getElementById('{{ form.festival_bonus.id_for_label }}').value) || 0;
            
            const providentFund = parseFloat(document.getElementById('{{ form.provident_fund.id_for_label }}').value) || 0;
            const tax = parseFloat(document.getElementById('{{ form.tax_deduction.id_for_label }}').value) || 0;
            const loan = parseFloat(document.getElementById('{{ form.loan_deduction.id_for_label }}').value) || 0;
            
            const totalAllowances = houseRent + medical + conveyance + food + attendanceBonus + festivalBonus;
            const totalDeductions = providentFund + tax + loan;
            const netSalary = baseSalary + totalAllowances - totalDeductions;
            
            // Update summary display
            document.getElementById('summary-base').textContent = '৳ ' + baseSalary.toLocaleString('en-US', {minimumFractionDigits: 2});
            document.getElementById('summary-allowances').textContent = '৳ ' + totalAllowances.toLocaleString('en-US', {minimumFractionDigits: 2});
            document.getElementById('summary-deductions').textContent = '৳ ' + totalDeductions.toLocaleString('en-US', {minimumFractionDigits: 2});
            document.getElementById('summary-net').textContent = '৳ ' + netSalary.toLocaleString('en-US', {minimumFractionDigits: 2});
        }
        
        // Add event listeners to salary fields
        const salaryFields = [
            '{{ form.base_salary.id_for_label }}',
            '{{ form.house_rent_allowance.id_for_label }}',
            '{{ form.medical_allowance.id_for_label }}',
            '{{ form.conveyance_allowance.id_for_label }}',
            '{{ form.food_allowance.id_for_label }}',
            '{{ form.attendance_bonus.id_for_label }}',
            '{{ form.festival_bonus.id_for_label }}',
            '{{ form.provident_fund.id_for_label }}',
            '{{ form.tax_deduction.id_for_label }}',
            '{{ form.loan_deduction.id_for_label }}'
        ];
        
        salaryFields.forEach(fieldId => {
            const field = document.getElementById(fieldId);
            if (field) {
                field.addEventListener('input', calculateSalarySummary);
            }
        });
        
        // Initialize summary on page load
        calculateSalarySummary();

        // Form validation
        const form = document.getElementById('employee-form');
        if (form) {
            form.addEventListener('submit', function(e) {
                let isValid = true;
                
                // Check required fields
                const requiredFields = form.querySelectorAll('[required]');
                requiredFields.forEach(field => {
                    if (!field.value.trim()) {
                        isValid = false;
                        field.classList.add('error');
                    } else {
                        field.classList.remove('error');
                    }
                });
                
                if (!isValid) {
                    e.preventDefault();
                    showToast('Please fill in all required fields', 'error');
                }
            });
        }

        // Toast notification function
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 animate-slide-in ${type === 'success' ? 'bg-success text-success-foreground' : type === 'error' ? 'bg-destructive text-destructive-foreground' : 'bg-card text-foreground border border-border'}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }
    });
</script>
{% endblock %}